<section><h1>Mettre le web<br>en page(s)</h1><p>Lucie Anglade â€” Guillaume Ayoub</p></section>
<section><h2>Lucie Anglade</h2><ul><li>IngÃ©nieure en informatique</li><li>DÃ©veloppeuse de logiciels libres</li><li>PrÃ©sidente de <a href="https://afpy.org/">lâ€™AFPy</a>, organisatrice des <a href="https://www.meetup.com/fr-FR/Python-AFPY-Lyon/">Meetups Python Ã  Lyon</a></li></ul></section>
<section><h2>Guillaume Ayoub</h2><ul><li>IngÃ©nieur en informatique</li><li>DÃ©veloppeur de logiciels libres</li><li>Ancien membre du W3C et lecteur assidu de spÃ©cifications</li></ul></section>
<section><h2>Que va-t-il se passer pendant cet atelierâ€¯?</h2><ul><li>Pourquoi ne pas utiliser LaTeX, Word, InDesignâ€¦â€¯?</li><li>Non, mais du HTML et du CSS pour faire des PDF, câ€™est pas prÃ©vu pour Ã§a, voyons, câ€™est pour faire du webâ€¯!</li><li>Et si on mettait en page un livreâ€¯?</li></ul></section>
<section><h2>Il Ã©tait une foisâ€¦</h2><p>Une petite entreprise lyonnaise qui gÃ©nÃ©rait divers documentsâ€¯: des factures, des rapports, des livrets de formationâ€¦</p><p>Pour gÃ©nÃ©rer ces documents, iels ont utilisÃ© diffÃ©rentes solutionsâ€¯: LibreOffice, LaTeXâ€¦</p></section>
<section><h2>Maisâ€¦</h2><p>MÃªme si ces logiciels sont trÃ¨s bien, ils ne sont pas adaptÃ©s Ã  la gÃ©nÃ©ration automatique de documents.</p><p>Plein de petites choses peuvent changer entre deux documents globalement identiques, et ce nâ€™est pas trÃ¨s pratique Ã  gÃ©rer avec ces outils.</p><p>Et puis, nâ€™essayez pas de demander Ã  unÂ·e graphiste de faire du design sur ces outils. En gÃ©nÃ©ral, iels refuseront poliment.</p></section>
<section><h2>Câ€™est alors queâ€¦</h2><p>Lâ€™idÃ©e dâ€™utiliser HTML et CSS pour crÃ©er des PDF Ã©mergea.</p><p>Une preuve de concept plus tard, voilÃ  un stagiaire lancÃ© sur le projet.</p></section>
<section><h2>Câ€™est pas un peu bizarre quand mÃªmeâ€¯?</h2><p>On connait bien HTML et CSS pour faire du web, mais en rÃ©alitÃ©, câ€™est prÃ©vu.</p><p>DÃ¨s la <a href="https://www.w3.org/TR/WD-CSS2-971104/cover.html">premiÃ¨re version de la spÃ©cification CSS</a> en 1996, on trouve tout un chapitre dÃ©diÃ© aux documents paginÃ©s.</p></section>
<section><h2>Bon, câ€™est quoi WeasyPrintâ€¯?</h2><p>WeasyPrint est une bibliothÃ¨que en Python qui permet de transformer du HTML et CSS en PDF.</p><p>Et câ€™est nous qui la dÃ©velopponsâ€¯!â€¯ğŸ’œ</p></section>
<section><h2>Ã‡a sâ€™installe commentâ€¯?</h2><p>WeasyPrint est packagÃ© dans de nombreuses distributions Linux.</p><p>Nâ€™hÃ©sitez pas Ã  jeter un Å“il Ã  <a href="https://doc.courtbouillon.org/weasyprint/stable/">la documentation</a> si jamais votre distribution favorite ne dispose pas (encore) de WeasyPrint.</p></section>
<section><h2>Et si on imprimait un trucâ€¯?</h2><p>Vous pouvez rÃ©cupÃ©rer le dÃ©pÃ´t des exemples sur <a href="https://github.com/CourtBouillon/weasyprint-samples">GitHub</a>.</p><p style="width: 150%"><code>weasyprint book.html book.pdf</code></p><p style="">Câ€™est pas trÃ¨s beau, il nâ€™y a que le style par dÃ©faut de WeasyPrint. Pas de panique, on va changer Ã§aâ€¯!</p>

</section>
<section><h2>Du CSSâ€¯pour des documents ou pour le web, câ€™est (presque) pareilâ€¯! </h2><p>On va pouvoir utiliser les mÃªmes sÃ©lecteurs et les mÃªmes propriÃ©tÃ©s.</p><p>Noteâ€¯: tout CSS nâ€™est pas (encore) supportÃ© dans WeasyPrint. Vous pouvez oublier <code>grid</code> pour lâ€™instant.</p></section>
<section><h2>Et si on cachait les imagesâ€¯?</h2><p>Dans un livre de poche, il nâ€™y a gÃ©nÃ©ralement pas dâ€™images. On va pouvoir les cacher en utilisant <code>display: none</code>.</p><p>Vous pouvez crÃ©er une feuille de style qui va servir Ã  dÃ©finir la mise en page de votre livre.</p><p>Pour que WeasyPrint prenne en compte cette feuille de style, vous pouvez ajouter un <code>link</code> dans le HTML ou utiliser lâ€™option <code>-s</code> en ligne de commande.</p><p><code>weasyprint book.html -s style.css book.pdf</code></p></section>
<section><h2>Mais avec des trucs en plusâ€¯!</h2><p>Certaines fonctionnalitÃ©s sont spÃ©cifiques aux documents paginÃ©s, comme par exempleâ€¦ les numÃ©ros de page.</p><p>Et plein dâ€™autresâ€¯:</p><ul><li>les coupures de page,</li><li>les en-tÃªtes et pieds de page,</li><li>les marges de page,</li><li>la table des matiÃ¨resâ€¦</li></ul></section>
<section><h2>Ã€ vous de jouerâ€¯!</h2><p>Mettez en page ce livre au format poche.</p><p>Nâ€™hÃ©sitez pas Ã  faire un petit dessin pour savoir oÃ¹ vous allez ou Ã  vous inspirez du rÃ©sultat disponible dans le dÃ©pÃ´t.</p></section>
<section><h2>Le livre serait bien mieux avec des numÃ©ros de page</h2><p>Pour rajouter les numÃ©ros de page (autrement appelÃ©s Â«â€¯foliosâ€¯Â»), on va se servir des <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/@page">rÃ¨gles <code>@page</code></a>.</p><p>Elles vont nous permettre dÃ©terminer les propriÃ©tÃ©s des pages, comme les marges et le contenu de ces marges (câ€™est lÃ  que lâ€™on va mettre les numÃ©ros).</p><p>Nous voulons aussi des compteurs. Les compteurs pour les pages existent de base. Ils sâ€™appellent <code>page</code> (pour la page en cours) et <code>pages</code> (pour le nombre total).</p></section>
<section>
  <h2>Les marges de page</h2>
  <img src="https://www.courtbouillon.org/static/images/00036-margin-boxes.png" style="display:block; margin-left:auto; margin-right:auto; margin-bottom: 1em; height:30vh">
  <pre><code class="css hljs">
@page {
  @bottom-center {
    content: counter(page) "â€¯/â€¯" counter(pages);
  }
}
  </code></pre>
</section>
<section><h2>Le livre serait bien mieux si lâ€™on passait Ã  la page suivante Ã  chaque chapitre</h2><p>Ã€ certains moments, on voudrait bien que le contenu passe Ã  la page dâ€™aprÃ¨s, et Ã  dâ€™autres moments que lâ€™on Ã©vite de couper. Pour cela, on utilise les propriÃ©tÃ©s <code>break-before</code>, <code>break-inside</code> et <code>break-after</code>.</p><p>La valeur <code>avoid</code> permet dâ€™empÃªcher la coupure, <code>page</code> permet de la forcer. On peut mÃªme choisir si lâ€™on coupe quand on est sur une page de droite ou de gaucheâ€¯!</p><p>Chaque chapitre est dans une section, on peut donc dire que lâ€™on veut passer Ã  la page suivante avant chacune dâ€™elles.</p></section>
<section><h2>Le livre serait bien mieux avec le titre du chapitre courant en haut de la page</h2><p>Il arrive souvent que lâ€™on veuille avoir un morceau du contenu qui se rÃ©pÃ¨te sur chaque page. Dans le cas dâ€™un livre, on aimerait avoir le titre du chapitre en cours.</p><p>Pour cela, on va utiliser les chaÃ®nes de caractÃ¨res nommÃ©es qui permettent de dÃ©finir une sorte de variable et son contenu <code>string-set: titre content();</code>.</p><p>La valeur se rÃ©cupÃ¨re en utilisant <code>string(titre)</code>.</p><p>Et on utilise aussi le placement dans les marges pour mettre le titre oÃ¹ lâ€™on veutâ€¯!</p></section>
<section><h2>Le livre serait bien mieux avec une table des matiÃ¨res</h2><p>Vous avez peut-Ãªtre remarquÃ© cette liste plutÃ´t vide au dÃ©but du HTML. Câ€™est grÃ¢ce Ã  elle que lâ€™on va pouvoir faire la table des matiÃ¨res.</p><p>Chaque Ã©lÃ©ment de la liste comporte un lien vers un chapitre. GrÃ¢ce Ã  ce lien, on peut rÃ©cupÃ©rer le titre du chapitre et sa page.</p><p>Pour le titre, on utilise <code>target-text(attr(href))</code>. Pour le numÃ©ro de la page, <code>target-counter(attr(href), page)</code>.</p><p>Oh, et les petits points que lâ€™on trouve dans les tables des matiÃ¨resâ€¯? Il existe une fonction en CSS pour faire celaâ€¯: <a href="https://www.courtbouillon.org/blog/00035-tips-and-tricks-leader"><code>leader()</code></a>.</p></section>
<section><h2>Alors, il ressemble Ã  quoi votre livreâ€¯?</h2></section>
<section><h2>Nâ€™hÃ©sitez pas Ã  suivre CourtBouillonâ€¯!</h2><ul>
    <li>Le site de <a href="https://courtbouillon.org">CourtBouillon</a> et <a href="https://weasyprint.org/">WeasyPrint</a></li>
  <li><a href="https://twitter.com/BouillonCourt">Twitter</a></li>
  <li><a href="https://fosstodon.org/@CourtBouillon">Mastodon</a></li>
  <li><a href="https://linkedin.com/company/courtbouillon">LinkedIn</a></li>
</ul></section>
